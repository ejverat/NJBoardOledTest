#include "board_test.h"

#include "mcc_generated_files/system/system.h"
#include "mcc_generated_files/timer/delay.h"
#include "mcc_generated_files/timer/tmr0.h"
#include "mcc_generated_files/system/pins.h"
#include "mcc_generated_files/spi/mssp1.h"

#include "gdisplay.h"
#include "SSD1322.h"

#include <stdarg.h>

unsigned char NHD_Logo [] = {
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0xF0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x01, 0xF8, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x03, 0xFC, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x03, 0xFF, 0xFF, 0xEE, 0x60, 0xFC, 0x71, 0x8E, 0x31, 0x81, 0xC1, 0xC3,
0x8F, 0xE3, 0x8C, 0x00, 0xFE, 0x0C, 0x1F, 0xE3, 0xF8, 0x70, 0x07, 0x06, 0x18, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x03, 0xFF, 0xFF, 0xEE, 0x61, 0xFC, 0x73, 0xCC, 0x31, 0x81, 0xE0, 0xC3,
0x1F, 0xE3, 0xCC, 0x00, 0xFF, 0x0C, 0x3F, 0xE3, 0xFC, 0x70, 0x07, 0x07, 0x38, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x03, 0xFC, 0x00, 0x0F, 0x61, 0x80, 0x33, 0xCC, 0x31, 0x81, 0x60, 0xC7,
0x18, 0x03, 0xCC, 0x00, 0xC3, 0x8C, 0x30, 0x03, 0x0C, 0x70, 0x0D, 0x83, 0x30, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x01, 0xF8, 0x7F, 0xED, 0x61, 0xFC, 0x3B, 0x4C, 0x3F, 0x83, 0x30, 0x66,
0x1F, 0xE3, 0x6C, 0x00, 0xC1, 0x8C, 0x3F, 0xC3, 0x0C, 0x70, 0x0D, 0x81, 0xE0, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0xF0, 0xFF, 0xED, 0xE1, 0xFC, 0x1A, 0x6C, 0x3F, 0x83, 0x30, 0x66,
0x1F, 0xE3, 0x6C, 0x00, 0xC1, 0x8C, 0x3F, 0xC3, 0xFC, 0x70, 0x18, 0xC0, 0xC0, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x01, 0xF0, 0x03, 0xC0, 0x0D, 0xE1, 0x80, 0x1E, 0x78, 0x31, 0x87, 0xF0, 0x3C,
0x18, 0x03, 0x3C, 0x00, 0xC1, 0x8C, 0x00, 0xE3, 0xF8, 0x70, 0x1F, 0xC0, 0xC0, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x03, 0xF8, 0x07, 0x80, 0x0C, 0xE1, 0xFC, 0x1E, 0x78, 0x31, 0x86, 0x18, 0x3C,
0x1F, 0xE3, 0x1C, 0x00, 0xC3, 0x8C, 0x00, 0xE3, 0x00, 0x70, 0x3F, 0xC0, 0xC0, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x03, 0xF8, 0x0F, 0x3F, 0xEC, 0x60, 0xFC, 0x0E, 0x70, 0x31, 0x8E, 0x1C, 0x38,
0x0F, 0xE3, 0x1C, 0x00, 0xFF, 0x0C, 0x3F, 0xE3, 0x00, 0x7F, 0x30, 0x60, 0xC0, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x03, 0xFF, 0xFC, 0x7F, 0xEC, 0x60, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0xFC, 0x0C, 0x1F, 0x83, 0x00, 0x3F, 0x30, 0x60, 0xC0, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x03, 0xFF, 0xF8, 0xE0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x03, 0xF8, 0x01, 0xC0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0xF1, 0xF0, 0x03, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x01, 0xFC, 0x00, 0x07, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x03, 0xFC, 0x00, 0x1E, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x03, 0xFF, 0xFF, 0xFC, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x03, 0xFF, 0xFF, 0xF8, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x01, 0xFC, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0xF8, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};

/* const uint8_t SSD1306_I2C_ADDR = 0x3C; */ /* 7-bit address */

const uint8_t SSD1306_SINGLE_MSK = 0x80;
const uint8_t SSD1306_STREAM_MSK = 0x00;

const uint8_t SSD1306_DATA_MSK = 0x40;
const uint8_t SSD1306_CMD_MSK = 0x00;
#define I2C_BUFFER_SIZE 128*8+1
static uint8_t i2c_buffer[I2C_BUFFER_SIZE];
static uint8_t* i2c_buffer_p;

inline void reset_i2c_buffer()
{
	i2c_buffer_p = &i2c_buffer[0];
}

inline void add_i2c_byte(uint8_t byte)
{
	*i2c_buffer_p = byte;
	i2c_buffer_p++;
}


inline bool send_i2c_buffer(uint8_t address)
{
	if(i2c2_host_interface.Write
			(address,i2c_buffer,(size_t)(i2c_buffer_p - i2c_buffer)))
	{
		DELAY_milliseconds(10);
		if(i2c2_host_interface.IsBusy())
		{
			return false;
		}
		if(i2c2_host_interface.ErrorGet() == I2C_ERROR_NONE)
		{
			return true;
		}
	}
	return false;
}

bool hw_test_i2c(uint8_t address)
{
	/*const uint8_t control_byte = 
		SSD1306_SINGLE_MSK | SSD1306_CMD_MSK;
	const uint8_t cmd = 0xE3;
#define TEST_DATA_LENGHT 2

	uint8_t pData[TEST_DATA_LENGHT];
	pData[0] = control_byte;
	pData[1] = cmd;
	return send_i2c_buffer(address,pData,TEST_DATA_LENGHT);*/
	return true;
}

/*static bool send_i2c_bytes(uint8_t address, uint8_t *buffer, size_t bytes, ...)
{
	va_list argp;
	va_start(argp,bytes);
	size_t i;
	for(i = 0 ; i < bytes ; i++)
	{
		buffer[i] = va_arg(argp,uint8_t);
	}
	va_end(argp);

	return send_i2c_buffer(address,buffer,bytes);
}*/

bool hw_test_display(uint8_t address)
{
	DELAY_milliseconds(100);
	reset_i2c_buffer();
	add_i2c_byte(SSD1306_STREAM_MSK | SSD1306_CMD_MSK);

	add_i2c_byte(0xAE);

	add_i2c_byte(0xD5);
	add_i2c_byte(0x81);


	add_i2c_byte(0x81);
	add_i2c_byte(0x7F);

	add_i2c_byte(0x20);
	add_i2c_byte(0x00);

	add_i2c_byte(0x40);

	add_i2c_byte(0xA8);
	add_i2c_byte(63);

	add_i2c_byte(0xDA);
	add_i2c_byte(0x02);

	add_i2c_byte(0xA0);

	add_i2c_byte(0xC0);

	add_i2c_byte(0xA6);

	add_i2c_byte(0x2E);

	add_i2c_byte(0xD9);
	add_i2c_byte(0x2);

	add_i2c_byte(0x8D);
	add_i2c_byte(0x14);

	add_i2c_byte(0xAF);

	return send_i2c_buffer(address);

}

void hw_test_display_pixel(uint8_t pixel)
{

}

//void hw_test_display_fill(uint8_t address)
void hw_test_display_fill(uint8_t address, uint8_t width, uint8_t height)
{


	DELAY_milliseconds(5000);
	reset_i2c_buffer();
	add_i2c_byte(SSD1306_STREAM_MSK | SSD1306_CMD_MSK);
	/* Set column (segment) from 0 to 127*/
	add_i2c_byte(0x21);
	add_i2c_byte(0);
	add_i2c_byte(width-1);
	/* Set row (page) from 0 to 3*/
	add_i2c_byte(0x22);
	add_i2c_byte(0);
	add_i2c_byte(height/8 - 1);

	send_i2c_buffer(address);

	reset_i2c_buffer();
	add_i2c_byte(SSD1306_STREAM_MSK | SSD1306_DATA_MSK);

	size_t i,j;
	add_i2c_byte(0b11111111);
	for (i=0; i<width-2; i++)
	{
		add_i2c_byte(0b00000001);
	}
	add_i2c_byte(0b11111111);
	for (i=0; i<(height/8)-2; i++)
	{
		add_i2c_byte(0b11111111);
		for (j=0; j<width-2; j++)
		{
			add_i2c_byte(0b00000000);
		}
		add_i2c_byte(0b11111111);
	}
	add_i2c_byte(0b11111111);
	for (i=0; i<width-2; i++)
	{
		add_i2c_byte(0b10000000);
	}
	add_i2c_byte(0b11111111);

	send_i2c_buffer(address);
}

static void oled_data(uint8_t byte)
{
	IO_DC_SetHigh();

	SPI1.ByteExchange(byte);

}

static void oled_command(uint8_t byte)
{
	IO_DC_SetLow();

	SPI1.ByteExchange(byte);

}

static void oled_set_column_address(uint8_t a, uint8_t b)
{
	oled_command(0x15);
	oled_data(a);
	oled_data(b);
}

static void oled_set_write_ram()
{
	oled_command(0x5c);
}

static void oled_set_read_ram()
{
	oled_command(0x5d);
}

static void oled_set_row_address(uint8_t a, uint8_t b)
{
	oled_command(0x75);
	oled_data(a);
	oled_data(b);
}

static void oled_set_remap(uint8_t a, uint8_t b)
{
	oled_command(0xA0);
	oled_data(a);
	oled_data(b);
}

static void oled_set_display_start_line(uint8_t a)
{
	oled_command(0xA1);
	oled_data(a);
}

static void oled_set_display_offset(uint8_t a)
{
	oled_command(0xA2);
	oled_data(a);
}

static void oled_display_mode(uint8_t a)
{
	oled_command(a);
}

static void oled_enable_partial_display(uint8_t a, uint8_t b)
{
	oled_command(0xA8);
	oled_data(a);
	oled_data(b);
}

static void oled_exit_partial_display()
{
	oled_command(0xA9);
}

static void oled_function_selection(uint8_t a)
{
	oled_command(0xAB);
	oled_data(a);
}

static void oled_set_sleep_mode(uint8_t a)
{
	oled_command(a);
}

static void oled_set_phase_length(uint8_t a)
{
	oled_command(0xB1);
	oled_data(a);
}

static void oled_set_display_clock_oscillator_frequency(uint8_t a)
{
	oled_command(0xB3);
	oled_data(a);
}

static void oled_enable_external_vsl(uint8_t a, uint8_t b)
{
	oled_command(0xB4);
	oled_data(a);
	oled_data(b);
}

static void oled_set_gpio(uint8_t a)
{
	oled_command(0xB5);
	oled_data(a);
}

static void oled_set_second_precharge_period(uint8_t a)
{
	oled_command(0xB6);
	oled_data(a);
}

static void oled_default_grayscale()
{
	oled_command(0xB9);
}

static void oled_set_precharge_voltage(uint8_t a)
{
	oled_command(0xBB);
	oled_data(a);
}

static void oled_set_vcomh_voltage(uint8_t a)
{
	oled_command(0xBE);
	oled_data(a);
}

static void oled_set_contrast_control(uint8_t a)
{
	oled_command(0xC1);
	oled_data(a);
}

static void oled_master_contrast_control(uint8_t a)
{
	oled_command(0xC7);
	oled_data(a);
}

static void oled_multiplex_ratio(uint8_t a)
{
	oled_command(0xCA);
	oled_data(a);
}

static void oled_display_enhancement(uint8_t a)
{
	oled_command(0xD1);
	oled_data(a);
	oled_data(0x20);
}

static void oled_set_command_lock(uint8_t a)
{
	oled_command(0xFD);
	oled_data(a);
}

static void oled_init()
{
	DELAY_milliseconds(2);
	IO_CS_SetLow();
	DELAY_milliseconds(2);

	oled_set_command_lock(0x12);
	oled_command(0xAE);
	oled_set_display_clock_oscillator_frequency(0x91);
	oled_multiplex_ratio(0x3F);
	oled_set_display_offset(0x00);
	oled_set_display_start_line(0x00);
	oled_set_remap(0x06,0x11);
	oled_function_selection(0x01);
	oled_enable_external_vsl(0xA0,0x05|0xfd);
	oled_set_contrast_control(0x9F);
	oled_master_contrast_control(0x0F);
	oled_default_grayscale();                        // Default Linear Grayscale Table    
	oled_set_phase_length(0xe2);                             // Set Phase Length       
	oled_display_enhancement(0x082|0x020);                          // Display Enhancement      
	oled_set_precharge_voltage(0x1f);                        // Set Precharge Voltage    
	oled_set_second_precharge_period(0x08);                  // Set Second Precharge Period    
	oled_set_vcomh_voltage(0x07);                            // Set VCOMH Voltage     
	oled_display_mode(0xA6);                                 // Set Normal Display    
	oled_exit_partial_display();                             // Exit Partial Display Mode    

	DELAY_milliseconds(2);
	oled_set_sleep_mode(0xAF);                               // Sleep Mode OFF
	DELAY_milliseconds(2);
	IO_CS_SetHigh();
}

static void oled_clear_display()
{

  size_t i, j;
  
	DELAY_milliseconds(2);
	IO_CS_SetLow();
	DELAY_milliseconds(2);
  oled_set_column_address(0x1C,0x5B);
  oled_set_row_address(0x00,0x3F);
  oled_set_write_ram();

  for(i=0;i<64;i++) //Columns
  {
    for(j=0;j<128;j++) //Rows
    {
      oled_data(0x00);
      DELAY_microseconds(100);
    }
  }
	DELAY_milliseconds(2);
	IO_CS_SetHigh();
}

static void oled_image_display(uint8_t *image)
{
  size_t i, j, buff;
	DELAY_milliseconds(2);
	IO_CS_SetLow();
	DELAY_milliseconds(2);
  oled_set_remap(0x14,0x11); 
//Set_Remap_25664(0x06,0x11); // To Flip Orientation 180 Degrees     
  oled_set_column_address(0x1C,0x5B);
  oled_set_row_address(0x00,0x3F);
  oled_set_write_ram(); 
                           
  for(i=0;i<64;i++) //Columns
  {
    for(j=0;j<32;j++) //Rows
    {
      buff = *image;
      buff = ((buff >> 6) & 0x03);
      if(buff == 0x03){oled_data(0xFF);}
      else if(buff == 0x02){oled_data(0xF0);}
      else if(buff == 0x01){oled_data(0x0F);}
      else oled_data(0x00);

      buff = *image;
      buff = ((buff >> 4) & 0x03);
      if(buff == 0x03){oled_data(0xFF);}
      else if(buff == 0x02){oled_data(0xF0);}
      else if(buff == 0x01){oled_data(0x0F);}
      else oled_data(0x00);

      buff = *image;
      buff = ((buff >> 2) & 0x03);
      if(buff == 0x03){oled_data(0xFF);}
      else if(buff == 0x02){oled_data(0xF0);}
      else if(buff == 0x01){oled_data(0x0F);}
      else oled_data(0x00);

      buff = *image;
      buff = (buff & 0x03);
      if(buff == 0x03){oled_data(0xFF);}
      else if(buff == 0x02){oled_data(0xF0);}
      else if(buff == 0x01){oled_data(0x0F);}
      else oled_data(0x00);

      image++;
    }
  }
	DELAY_milliseconds(2);
	IO_CS_SetHigh();
	DELAY_milliseconds(2);
}

void hw_test_display_fill_25664()
{
	//reset status
	DELAY_milliseconds(1000);
	SPI1.Open(0);

	IO_CS_SetHigh();
	IO_DC_SetLow();

	IO_RES_SetLow();
	DELAY_milliseconds(150);
	IO_RES_SetHigh();
	DELAY_milliseconds(300);

	oled_init();

	DELAY_milliseconds(2000);
	oled_clear_display();
	DELAY_milliseconds(2000);
	oled_image_display(NHD_Logo);
	DELAY_milliseconds(5000);
	
}

void hw_test_display_fill_25664_v2()
{
	//reset status
	ssd1322_setup(64, 256);
	gdisplay_t* gd = ssd1322_get_gd();
	gd->init_fn();

	DELAY_milliseconds(2000);
	gd->clear_fn();
	DELAY_milliseconds(2000);
	gd->draw_fn(0,0,NHD_Logo,0);
	DELAY_milliseconds(5000);
}

void hw_test_display_fill();

static void tmr0_callback()
{
	OUT1_Toggle();
}

void hw_test_osc()
{
	Timer0_Initialize();
	Timer0_OverflowCallbackRegister(tmr0_callback);
}
